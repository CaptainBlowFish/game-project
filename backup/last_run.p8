pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
--mr duck man!!
function _init()
    player = {
        x = 70,--left
        y = 80,--top
        dx = 0,--movement on the x axis
        dy = 1, --movement on the y axis
        max_dx = 2,
        max_dy = 4,
        falling = true,
        can_jump = true,
        facing_left = false,
        runing_sprite_1 = false,
        current_sprite = 1,
        cam = {
            x = 0,
            y = 0
        }
    }
    update_animations = true --will halve the frame rate 
end

function _update()
    if player.can_jump and (btn(❎) or btn(⬆️)) then
        jump()
    else
        if player.dy>0 then
            player.falling = true
            player.dy = 1
        elseif player.facing_left then
            if not fget(mget(flr((player.x+5)/8),flr(player.y/8)+1),1) and not player.falling then
                player.falling = true
                player.dy  = .1
            end
        elseif not player.facing_left then
            if not fget(mget(flr((player.x)/8),flr(player.y/8)+1),1) and not player.falling then
                player.falling = true
                player.dy  = .1
            end
        end
    end

    if player.falling then
        player.y += player.dy
    else
        player.y -= player.dy
    end


    if btn(⬅️) then
        move(true)
    elseif btn(➡️) then
        move(false)
    else
        player.dx -=.1
        if (player.dx < 0) player.dx = 0
    end

    if player.facing_left then
        player.x -= player.dx
    else
        player.x += player.dx
    end

    handle_map_collision()
end

function _draw()
    cls()
    move_cam()
    camera(player.cam.x, player.cam.y)
    mapdraw(0,0,0,0,16,16)


    spr(player.current_sprite,player.x,player.y,1,1,player.facing_left,player.falling)
    if update_animations then
        update_player_sprite()
    end
    update_animations = not update_animations
end

-->8
--graphics
function update_player_sprite()
    if player.dx >0 then 
        player.runing_sprite_1 = not player.runing_sprite_1
        if player.runing_sprite_1 then
            player.current_sprite = 3
        else
            player.current_sprite = 2
        end
    else
        player.current_sprite = 1
    end
end

function move_cam()
    screen_size = 128
    player.cam.x = player.x - screen_size/2
    player.cam.y = 0

    if (player.cam.x < 0) player.cam.x = 0
end

-->8
--movement
function move(left)
    --has the player move left or right
    if left then
        player.facing_left = true
    else
        player.facing_left = false
    end
    player.dx += .1
    if player.dx > player.max_dx then
        player.dx = player.max_dx
    end

end

function jump()
    --has the player jump
    if not player.falling then
        player.dy += .5
        if player.dy > player.max_dy then
            player.falling = true
            player.can_jump = false
        end
    end 
end

function handle_map_collision()
    --handles the player colliding with the map
    x = player.x/8 --divides by 8 to get the position of the player relative to the map
    y = player.y/8 -- a map square is an 8x8 square of pixels
    if player.facing_left then
        x = flr(x)
    else
        x = ceil(x)
    end
    if player.falling then
        y = ceil(y)
    else
        y = flr(y)
    end
    if fget(mget(x,y),1) then
        if player.falling then
            player.can_jump = true
            player.falling = false
            player.dy = 0
            player.y = (y-1)*8
        elseif player.dx> 0 then
            player.dx = 0
            if player.facing_left then
                player.x = (x+1)*8
            else 
                player.x = (x-1)*8
            end
        end
        

    end
end

__gfx__
00000000000003000000030000000300c11c11c133bb3bb3444444446655555600077750b333333b000000000000000000000000000000000000000000000000
0000000000003330000003300000033011c11c113b33b33374f7ff47555666660077775033bbbb3b000000000000000000000000000000000000000000000000
007007000000371a0000071a3000071a1cc1cc1c33333333fff44fff56665555076767503bb3bb33000000000000000000000000000000000000000000000000
000770000333333a0003333a3373333a1c11c11c333333444444747466555666777777503b333bb3000000000000000000000000000000000000000000000000
00077000377733300077333003773330111c11c144434444474777ff65566665076667503b333bb3000000000000000000000000000000000000000000000000
0070070000333300003333009933330011cc1cc14f44444ffffff44465666555007777503bb33bb3000009990000000000000000000000000000000000000000
000000000009900000909000900900001cc11c11f444f4f4f444744755665566000077503bbbbb33000009990000000000000000000000000000000000000000
000000000099990000009900000990001cc1cc1cffffffff747fffff5666566600000050b333b33b000009990000000000000000000000000000000000000000
0000000000000000000000000000000042244422000000000000000000000000000000504ff4ff4f000000000000000000000000000000000000000000000000
0000000000000000000000000000000042242224000000000000000000000000000000504ff4ff44000000000000000000000000000000000000000000000000
00000000000000000000000000000000224424440000000000000000000000000000005044f44ff4000000000000000000000000000000000000000000000000
000000000000000000000000000000002442242200000000000000000000000000000050f4ff44ff000000000000000000000000000000000000000000000000
000000000000000000000080000000002422442200000000000000000000000000000050f44ff4ff000000000000000000000000000000000000000000000000
000000000bb000b80b0000b00000b0004422422400000000000000000000000000000050ff4ff4ff000000000000000000000000000000000000000000000000
00000000bbbbbbb00bbb0bb000bb0bbb42244224000000000000000000000000000000504f4ff44f000000000000000000000000000000000000000000000000
00000000b000b0000000b0000b00000842242244000000000000000000000000000000504f44ff4f000000000000000000000000000000000000000000000000
00000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000004f4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004fff400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004ff4ff40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000004f4fff400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000004ffff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004ff40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001010104020202080008000000000000202020040000000800000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000060606000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000060606000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000060606000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000900000000000000000005050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001900000000000000000006060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001900000000000000050500040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000001900000000000000050404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505040404050404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
