pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
--mr duck man!!
function _init()
    player = {
        x = 10,--left
        y = 80,--top
        dx = 0,--movement on the x axis
        dy = 1, --movement on the y axis
        max_dx = 4,
        max_dy = 4,
        fall_speed = .2,
        falling = true,
        can_jump = true,
        facing_left = false,
        runing_sprite_1 = false,
        current_sprite = 1,
        map_width = 127,
        map_height = 16,
        alive = true,
        cam = {
            x = 0,
            y = 0
        }
    }
    update_animations = true --will halve the frame rate 
end

function _update()
    if player.can_jump and (btn(❎) or btn(⬆️)) then
        jump()
    else
        if player.dy>0 then
            player.falling = true
            player.dy = 1
        elseif player.facing_left then
            if not fget(mget(ceil((player.x+5)/8),flr(player.y/8)+1),1) and not player.falling then
                player.falling = true
                player.dy  = player.fall_speed
            end
        elseif not player.facing_left then
            if not fget(mget(ceil((player.x+1)/8),flr(player.y/8)+1),1) and not player.falling then
                player.falling = true
                player.dy  = player.fall_speed
            end
        end
    end

    if player.falling then
        player.y += player.dy
    else
        player.y -= player.dy
    end


    if btn(⬅️) then
        move(true)
    elseif btn(➡️) then
        move(false)
    else
        player.dx -= .1
        if (player.dx < 0) player.dx = 0
    end

    if player.facing_left then
        player.x -= player.dx
    else
        player.x += player.dx
    end

    handle_map_collision()
end

function _draw()
    cls(12)
    
    move_cam()
    camera(player.cam.x, player.cam.y)
    mapdraw(1,0,0,0,player.map_width,player.map_height)
    sspr(0,32,40,16,0,0,160,64)
    spr(player.current_sprite,player.x,player.y,1,1,player.facing_left,player.falling)
    if update_animations then
        update_player_sprite()
    end
    update_animations = not update_animations
end

-->8
--graphics
function update_player_sprite()
    if player.dx >0 then 
        player.runing_sprite_1 = not player.runing_sprite_1
        if player.runing_sprite_1 then
            player.current_sprite = 3
        else
            player.current_sprite = 2
        end
    else
        player.current_sprite = 1
    end
end

function move_cam()
    screen_size = 128
    player.cam.x = player.x - screen_size/2
    player.cam.y = 0

    if (player.cam.x < 0) player.cam.x = 0
end

-->8
--movement
function move(left)
    --has the player move left or right
    if left then
        player.facing_left = true
    else
        player.facing_left = false
    end
    player.dx += .1
    if player.dx > player.max_dx then
        player.dx = player.max_dx
    end

end

function jump()
    --has the player jump
    if not player.falling then
        player.dy += .5
        if player.dy > player.max_dy then
            player.falling = true
            player.can_jump = false
        end
    end 
end

function handle_map_collision()
    --handles the player colliding with the map
    x = player.x/8 --divides by 8 to get the position of the player relative to the map
    y = player.y/8 -- a map square is an 8x8 square of pixels
    if player.facing_left then
        x = ceil(x)
    else
        x = ceil(x)+1
    end
    if player.falling then
        y = ceil(y)
    else
        y = flr(y)
    end
    if fget(mget(x,y),1) then --flag 1 is for walkable land
        if player.falling then
            player.can_jump = true
            player.falling = false
            player.dy = 0
            player.y = (y-1)*8
        elseif player.dx> 0 then
            player.dx = 0
            if player.facing_left then
                player.x = (x)*8
            else 
                player.x = (x-2)*8
            end
        end
    elseif fget(mget(x,y),2) then

    end
end

__gfx__
00000000000003000000030000000300c11c11c133bb3bb3444444446655555600077750b333333b000000000000000000000000000000000000000000000000
0000000000003330000033300000333011c11c113b33b33374f7ff47555666660077775033bbbb3b000000000000000000000000000000000000000000000000
007007000000371a0000371a4000371a1cc1cc1c33333333fff44fff56665555076767503bb3bb33000000000000000000000000000000000000000000000000
000770000444433a4474333a4474333a1c11c11c333333444444747466555666777777503b333bb3000000000000000000000000000000000000000000000000
00077000477744304077443004774430111c11c144434444474777ff65566665076667503b333bb3000000000000000000000000000000000000000000000000
0070070000444400004444009944440011cc1cc14f44444ffffff44465666555007777503bb33bb3000009990000000000000000000000000000000000000000
000000000009900009909000900900001cc11c11f444f4f4f444744755665566000077503bbbbb33000009990000000000000000000000000000000000000000
000000000099990009009900000990001cc1cc1cffffffff747fffff5666566600000050b333b33b000009990000000000000000000000000000000000000000
0000000000000000000000000000000042244422000000000000000000000000000000504ff4ff4f000000000000000000000000000000000000000000000000
0000000000000000000000000000000042242224000000000000000000000000000000504ff4ff44000000000000000000000000000000000000000000000000
00000000000000000000000000000000224424440000000000000000000000000000005044f44ff4000000000000000000000000000000000000000000000000
000000000000000000000000000000002442242200000000000000000000000000000050f4ff44ff000000000000000000000000000000000000000000000000
000000000000000000000080000000002422442200000000000000000000000000000050f44ff4ff000000000000000000000000000000000000000000000000
000000000bb000b80b0000b00000b0004422422400000000000000000000000000000050ff4ff4ff000000000000000000000000000000000000000000000000
00000000bbbbbbb00bbb0bb000bb0bbb42244224000000000000000000000000000000504f4ff44f000000000000000000000000000000000000000000000000
00000000b000b0000000b0000b00000842242244000000000000000000000000000000504f44ff4f000000000000000000000000000000000000000000000000
00000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000004f4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004fff400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004ff4ff40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000004f4fff400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000004ffff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004ff40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
76767600000000000000000000077600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777760767760000000000000777600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77676760776676000000000007777760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77070760776060000000000077767777760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66000600776000000000000077606677660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000776077600776676000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77776000000000000000776000007767777600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777760000000000000776000007677767600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77667776000000000000776000000776777600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77606776000000000000776076000660776076000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77600676000000000000776776000007760777600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77600076776000007760777760000006607766760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77600776776076776676777600000000077600760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77607760776076776060777600000000066007600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777760776676776076776760000000000076000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77776600777760077760770676000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001010104020202080008000000000000202020040000000800000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000900000000000000000005050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500001900000000000000000006060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500001900000000000000050500040400050505050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500001900000000000000050404040400000000000005050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505040505050504040404040400000000000000000505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606040404040404040404040400000000000000000000000000000505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
